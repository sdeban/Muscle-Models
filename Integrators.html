<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1504.83">
  <style type="text/css">
    p.p1 {
      margin: 0.0px 0.0px 0.0px 0.0px;
      font: 24.0px Garamond
    }

    p.p2 {
      margin: 0.0px 0.0px 0.0px 0.0px;
      font: 24.0px Garamond;
      min-height: 27.0px
    }

    p.p3 {
      margin: 0.0px 0.0px 0.0px 4.0px;
      text-indent: -4.0px;
      font: 24.0px Garamond
    }

    p.p4 {
      margin: 0.0px 0.0px 0.0px 4.0px;
      text-indent: -4.0px;
      font: 24.0px Garamond;
      min-height: 27.0px
    }

  </style>
</head>

<body>
  <p class="p1"><b>Semi-implicit Euler integration, aka Symplectic Euler (fast and stable, and conserves energy).</b></p><br>
  <p class="p1"><b>Acceleration</b></p>
  <p class="p1">a[i]=F[i-1]/m</p>
  <p class="p2"><br></p>
  <p class="p1">and either these two, if you want velocity based explicitly on the last velocity and acceleration, and the position based implicitly on the current estimate of velocity:</p>
  <p class="p1"><b>Velocity</b></p>
  <p class="p3">v[i] = v[i-1] + a[i-1] * timeStep<span class="Apple-converted-space"> </span></p>
  <p class="p3"><b>Position</b></p>
  <p class="p1">x[i] = x[i-1] + v[i] * timeStep</p>
  <p class="p2"><br></p>
  <p class="p1"><b>or</b> these two, if you want position based explicitly on the last position and velocity, and the velocity based implicitly on the current estimate of acceleration:</p>
  <p class="p1"><b>Velocity</b></p>
  <p class="p3">v[i] = v[i-1] + a[i] * timeStep</p>
  <p class="p3"><b>Position</b></p>
  <p class="p1">x[i] = x[i-1] + v[i-1] * timeStep</p>
  <p class="p2"><br></p>
  <p class="p2"><br></p>
  <p class="p2"><br></p>
  <p class="p1"><b>Velocity Verlet integration (simple and quite accurate with small time steps and conserves energy).</b></p>
  <p class="p2"><b></b><br></p>
  <p class="p1"><b>Acceleration</b></p>
  <p class="p1">a[i]=F[i-1]/m<span class="Apple-converted-space"> </span></p>
  <p class="p2"><br></p>
  <p class="p1"><b>Velocity</b></p>
  <p class="p3">v[i] = v[i-1] + (a[i]+a[i-1])/2 * timeStep</p>
  <p class="p4"><br></p>
  <p class="p3"><b>Position</b></p>
  <p class="p1">x[i] = x[i-1] + v[i-1] * timeStep + (a[i]/2) * timeStep^2</p>
  <p class="p4"><br></p>
  <p class="p4"><br></p>
  <p class="p4"><br></p>
  <p class="p1"><b>Runge-Kutta 4th order integration (more complex and very accurate with even large time steps, but loses energy slowly, i.e., has a dampening effect).</b></p>
  <p class="p2"><b></b><br></p>
  <p class="p3">p1 = last position</p>
  <p class="p3">v1 = last velocity</p>
  <p class="p3">a1 = acceleration using equations of motion at p1 and v1, which means a=F/m for the projectile mass where F is defined as the spring force at p1 and v1. Because spring force is not dependent on v, it would just be spring force as a function of p1.<span class="Apple-converted-space">  </span>In the case of muscle mass, force and acceleration will depend on both p1 and v1 (length and velocity according to my defined functions).</p>
  <p class="p4"><br></p>
  <p class="p3">p2 = p1 + v1 * timestep/2</p>
  <p class="p3">v2 = v1 + a1 * timestep/2</p>
  <p class="p3">a2 = acceleration given p2 and v2, as above.</p>
  <p class="p4"><br></p>
  <p class="p3">p3 = p1 + v2 * timestep/2</p>
  <p class="p3">v3 = v1 + a2 * timestep/2</p>
  <p class="p3">a3 = acceleration given p3 and v3.</p>
  <p class="p4"><br></p>
  <p class="p3">p4 = p1 + v3 * timestep</p>
  <p class="p3">v4 = v1 + a3 * timestep</p>
  <p class="p3">a4 = acceleration given p4 and v4.</p>
  <p class="p4"><br></p>
  <p class="p3">new position = last position + (v1 + 2*v2 + 2*v3 + v4)*timestep/6</p>
  <p class="p3">new velocity = last velocity + (a1 + 2*a2 + 2*a3 + a4)*timestep/6</p>
</body>

</html>
